<mxfile host="65bd71144e">
    <diagram name="Upstream Account View (MC as IdP)" id="upstream-view-1">
        <mxGraphModel dx="3956" dy="561" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1800" pageHeight="1000" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="52" value="" style="whiteSpace=wrap;html=1;aspect=fixed;spacing=6;strokeWidth=2;fillColor=#dae8fc;strokeColor=light-dark(#2a71d5, #5c79a3);" vertex="1" parent="1">
                    <mxGeometry x="1090" y="820" width="450" height="450" as="geometry"/>
                </mxCell>
                <mxCell id="50" value="" style="whiteSpace=wrap;html=1;aspect=fixed;spacing=6;strokeWidth=2;fillColor=#dae8fc;strokeColor=light-dark(#2a71d5, #5c79a3);" vertex="1" parent="1">
                    <mxGeometry x="620" y="820" width="450" height="450" as="geometry"/>
                </mxCell>
                <mxCell id="39" value="" style="whiteSpace=wrap;html=1;aspect=fixed;spacing=6;labelBorderColor=default;strokeWidth=3;strokeColor=default;gradientColor=none;fillStyle=dots;glass=0;rounded=0;shadow=0;" vertex="1" parent="1">
                    <mxGeometry x="1090" y="1130" width="120" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="38" value="" style="whiteSpace=wrap;html=1;aspect=fixed;spacing=6;strokeWidth=3;" vertex="1" parent="1">
                    <mxGeometry x="950" y="1130" width="120" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="title" value="Unified Solution: Mooncake (contoso.cn) as IdP, Global (contoso.com) as SP" style="text;whiteSpace=wrap;html=1;align=left;verticalAlign=middle;fontSize=18;fontStyle=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="360" y="60" width="1480" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="user" value="" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=14;image=img/lib/azure2/identity/Users.svg;" vertex="1" parent="1">
                    <mxGeometry x="-30" y="370" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="user-label" value="User Login" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="-50" y="470" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="mc-group" value="Mooncake Tenant (contoso.cn) — IdP" style="swimlane;rounded=1;html=1;horizontal=1;startSize=36;fillColor=#F2F6FC;strokeColor=#0078D4;strokeWidth=2;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="340" y="140" width="680" height="596.11" as="geometry"/>
                </mxCell>
                <mxCell id="mc-vm" value="Virtual Machine" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/compute/Virtual_Machines_Classic.svg;points=[];" vertex="1" parent="mc-group">
                    <mxGeometry x="370" y="70" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-appgw" value="App Gateway" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/networking/Application_Gateways.svg;" vertex="1" parent="mc-group">
                    <mxGeometry x="470" y="70" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-sql" value="Azure Firewalls" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/mscae/Azure_Firewall.svg;sketch=0;points=[];" vertex="1" parent="mc-group">
                    <mxGeometry x="570" y="70" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-storage" value="Storage Account" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/storage/Storage_Accounts.svg;" vertex="1" parent="mc-group">
                    <mxGeometry x="370" y="170" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-keyvault" value="Key Vault" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/security/Key_Vaults.svg;" vertex="1" parent="mc-group">
                    <mxGeometry x="470" y="170" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-azure-label" value="Azure Resources and Infra Safeguared (MC Cloud)" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;" vertex="1" parent="mc-group">
                    <mxGeometry x="402" y="280" width="168" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="4" value="..." style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;" vertex="1" parent="mc-group">
                    <mxGeometry x="570" y="180" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-teams" value="Teams" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_Teams.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_teams;" vertex="1" parent="mc-group">
                    <mxGeometry x="50" y="70" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-outlook" value="Outlook" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_Outlook.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_outlook;" vertex="1" parent="mc-group">
                    <mxGeometry x="150" y="70" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-sharepoint" value="SharePoint" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_SharePoint_Online.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_sharepoint;" vertex="1" parent="mc-group">
                    <mxGeometry x="50" y="170" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-onedrive" value="OneDrive" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_OneDrive_for_Business.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_onedrive;" vertex="1" parent="mc-group">
                    <mxGeometry x="150" y="170" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-m365-label" value="M365 Services (Safguarded In Gallatin)" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;" vertex="1" parent="mc-group">
                    <mxGeometry x="80" y="280" width="168" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="25" value="..." style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;" vertex="1" parent="mc-group">
                    <mxGeometry x="230" y="170" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="30" value="Microsoft Purview" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/databases/Azure_Purview_Accounts.svg;points=[];" vertex="1" parent="mc-group">
                    <mxGeometry x="240" y="70" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-group" value="Global Tenant (contoso.com) — SP" style="swimlane;rounded=1;html=1;horizontal=1;startSize=36;fillColor=#F2F6FC;strokeColor=#0078D4;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="1160" y="140" width="750" height="590" as="geometry"/>
                </mxCell>
                <mxCell id="gl-webapp" value="Web App" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/app_services/App_Services.svg;" vertex="1" parent="gl-group">
                    <mxGeometry x="470" y="190" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-cosmosdb" value="Cosmos DB" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/databases/Azure_Cosmos_DB.svg;" vertex="1" parent="gl-group">
                    <mxGeometry x="560" y="60" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-azure-label" value="Mangae Azure Resources/M365 with fully safeguarded (Global)" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;" vertex="1" parent="gl-group">
                    <mxGeometry x="100" y="320" width="370" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="5" value="Virtual Machine" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/compute/Virtual_Machines_Classic.svg;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="660" y="60" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-power-platform" value="AI Foundary" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/ai_machine_learning/Azure_OpenAI.svg;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="370" y="60" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-powerbi" value="Power BI" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/power_platform/PowerBI.svg;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="470" y="60" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-sentinel" value="Azure Sentinel" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/security/Azure_Sentinel.svg;" vertex="1" parent="gl-group">
                    <mxGeometry x="380" y="190" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-defender-cloud" value="Defenders" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/security/MS_Defender_EASM.svg;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="160" y="190" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-purview" value="Microsoft Purview" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/databases/Azure_Purview_Accounts.svg;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="270" y="190" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-ellipsis" value="..." style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;" vertex="1" parent="gl-group">
                    <mxGeometry x="660" y="190" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="6" value="Teams" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_Teams.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_teams;" vertex="1" parent="gl-group">
                    <mxGeometry x="50" y="60" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="10" value="Outlook" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_Outlook.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_outlook;" vertex="1" parent="gl-group">
                    <mxGeometry x="160" y="60" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="12" value="OneDrive" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_OneDrive_for_Business.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_onedrive;" vertex="1" parent="gl-group">
                    <mxGeometry x="270" y="60" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="14" value="DDoS Protection" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/networking/DDoS_Protection_Plans.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=image;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="50" y="190" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="33" value="" style="shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#EF8F21;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;align=center;outlineConnect=0;shape=mxgraph.veeam.2d.end_to_end_encryption;" vertex="1" parent="gl-group">
                    <mxGeometry x="532.5" y="430" width="85" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="34" value="**Data Encrypted while Storage and Transmition" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="gl-group">
                    <mxGeometry x="435" y="380" width="280" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="53" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/power_platform/CopilotStudio.svg;" vertex="1" parent="gl-group">
                    <mxGeometry x="560" y="192.84" width="68" height="62.32" as="geometry"/>
                </mxCell>
                <mxCell id="54" value="Copilot" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="gl-group">
                    <mxGeometry x="562.5" y="258" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="mc-entra" value="Microsoft Entra ID Mooncake (IdP)" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=14;image=img/lib/azure2/identity/Azure_Active_Directory.svg;fontFamily=Helvetica;fontColor=default;strokeColor=#0078D4;strokeWidth=2;fillColor=#E6F2FB;" parent="1" vertex="1">
                    <mxGeometry x="645" y="530" width="210" height="121.15" as="geometry"/>
                </mxCell>
                <mxCell id="22" value="" style="shape=flexArrow;endArrow=classic;startArrow=classic;html=1;" edge="1" parent="1" target="gl-sp">
                    <mxGeometry width="100" height="100" relative="1" as="geometry">
                        <mxPoint x="855" y="590.0799999999999" as="sourcePoint"/>
                        <mxPoint x="1265" y="591.15" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="23" value="&lt;b&gt;**User Data Store in Mooncake&lt;/b&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="405" y="541.15" width="200" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="24" value="" style="shape=image;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;labelBackgroundColor=default;verticalAlign=top;verticalLabelPosition=bottom;aspect=fixed;perimeter=ellipsePerimeter;shadow=0;dashed=0;spacingTop=3;image=img/lib/active_directory/sql_server.svg;" vertex="1" parent="1">
                    <mxGeometry x="465" y="591.15" width="60" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="gl-sp" value="Entra ID Global" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=14;image=img/lib/azure2/identity/Azure_Active_Directory.svg;fontFamily=Helvetica;fontColor=default;strokeColor=#0078D4;strokeWidth=1.5;fillColor=#FFFFFF;" parent="1" vertex="1">
                    <mxGeometry x="1265" y="531.15" width="210" height="121.15" as="geometry"/>
                </mxCell>
                <mxCell id="19" value="SAML SSO (NameID align with ImmutableID)" style="text;whiteSpace=wrap;html=1;align=left;verticalAlign=middle;fontSize=18;fontStyle=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="895" y="531.15" width="610" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="26" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/intune/Device_Compliance.svg;" vertex="1" parent="1">
                    <mxGeometry x="150" y="370" width="62" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="28" value="" style="shape=flexArrow;endArrow=classic;html=1;exitX=1.054;exitY=0.524;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="user">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="40" y="404" as="sourcePoint"/>
                        <mxPoint x="130" y="400" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="29" value="Intune Managed Devices" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="120" y="470" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="31" value="" style="shape=flexArrow;endArrow=classic;html=1;exitX=1.054;exitY=0.524;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="222" y="400.41" as="sourcePoint"/>
                        <mxPoint x="310" y="400" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="35" value="" style="sketch=0;pointerEvents=1;shadow=0;dashed=0;html=1;strokeColor=none;fillColor=#505050;labelPosition=center;verticalLabelPosition=bottom;verticalAlign=top;outlineConnect=0;align=center;shape=mxgraph.office.security.active_directory;" vertex="1" parent="1">
                    <mxGeometry x="970" y="1030" width="220" height="180" as="geometry"/>
                </mxCell>
                <mxCell id="36" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Entra_Connect_Sync.svg;" vertex="1" parent="1">
                    <mxGeometry x="690" y="850" width="120" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="37" value="" style="image;aspect=fixed;html=1;points=[];align=center;fontSize=12;image=img/lib/azure2/other/Entra_Connect_Sync.svg;" vertex="1" parent="1">
                    <mxGeometry x="1320" y="850" width="120" height="120" as="geometry"/>
                </mxCell>
                <mxCell id="41" value="" style="shape=flexArrow;endArrow=classic;html=1;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="750" y="830" as="sourcePoint"/>
                        <mxPoint x="749.41" y="700" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="42" value="" style="shape=flexArrow;endArrow=classic;html=1;" edge="1" parent="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1370.5900000000001" y="830" as="sourcePoint"/>
                        <mxPoint x="1370" y="700" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="43" value="" style="shape=flexArrow;endArrow=classic;html=1;exitX=0.007;exitY=0.171;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="38">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="940.59" y="1130" as="sourcePoint"/>
                        <mxPoint x="780" y="990" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="44" value="" style="shape=flexArrow;endArrow=classic;html=1;exitX=0.986;exitY=0.154;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="39">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="1541" y="1210" as="sourcePoint"/>
                        <mxPoint x="1330" y="990" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="46" value="Entra ID Connect" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="816" y="860" width="168" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="47" value="Entra ID Connect" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="1382" y="1000" width="168" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="48" value="Partitioned On-prem AD" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;" vertex="1" parent="1">
                    <mxGeometry x="984" y="1300" width="168" height="30" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>