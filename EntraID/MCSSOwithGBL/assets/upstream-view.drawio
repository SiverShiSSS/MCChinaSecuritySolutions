<mxfile host="65bd71144e">
    <diagram name="Upstream Account View (MC as IdP)" id="upstream-view-1">
        <mxGraphModel dx="1833" dy="477" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1800" pageHeight="1000" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="title" value="Upstream Solution: Mooncake (contoso.cn) as IdP, Global (contoso.com) as SP" style="text;whiteSpace=wrap;html=1;align=left;verticalAlign=middle;fontSize=18;fontStyle=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
                    <mxGeometry x="160" y="40" width="1480" height="40" as="geometry"/>
                </mxCell>
                <mxCell id="user" value="" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=14;image=img/lib/azure2/identity/Users.svg;" vertex="1" parent="1">
                    <mxGeometry x="60" y="370" width="60" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="user-label" value="User Login" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;" vertex="1" parent="1">
                    <mxGeometry x="40" y="470" width="100" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="mc-group" value="Mooncake Tenant (contoso.cn) — IdP" style="swimlane;rounded=1;html=1;horizontal=1;startSize=36;fillColor=#F2F6FC;strokeColor=#0078D4;strokeWidth=2;fontStyle=1" parent="1" vertex="1">
                    <mxGeometry x="140" y="120" width="680" height="596.11" as="geometry"/>
                </mxCell>
                <mxCell id="mc-entra" value="Microsoft Entra ID Mooncake (IdP)" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=14;image=img/lib/azure2/identity/Azure_Active_Directory.svg;fontFamily=Helvetica;fontColor=default;strokeColor=#0078D4;strokeWidth=2;fillColor=#E6F2FB;" parent="mc-group" vertex="1">
                    <mxGeometry x="260" y="68.85" width="210" height="121.15" as="geometry"/>
                </mxCell>
                <mxCell id="mc-teams" value="Teams" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_Teams.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_teams;" vertex="1" parent="mc-group">
                    <mxGeometry x="60" y="280" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-outlook" value="Outlook" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_Outlook.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_outlook;" vertex="1" parent="mc-group">
                    <mxGeometry x="160" y="280" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-sharepoint" value="SharePoint" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_SharePoint_Online.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_sharepoint;" vertex="1" parent="mc-group">
                    <mxGeometry x="60" y="380" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="13" value="" style="edgeStyle=none;html=1;" edge="1" parent="mc-group" source="mc-onedrive" target="mc-sharepoint">
                    <mxGeometry relative="1" as="geometry"/>
                </mxCell>
                <mxCell id="mc-onedrive" value="OneDrive" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_OneDrive_for_Business.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_onedrive;" vertex="1" parent="mc-group">
                    <mxGeometry x="160" y="380" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-vm" value="Virtual Machine" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/compute/Virtual_Machines_Classic.svg;points=[];" vertex="1" parent="mc-group">
                    <mxGeometry x="360" y="280" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-appgw" value="App Gateway" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/networking/Application_Gateways.svg;" vertex="1" parent="mc-group">
                    <mxGeometry x="460" y="280" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-sql" value="SQL Database" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/databases/Azure_SQL.svg;" vertex="1" parent="mc-group">
                    <mxGeometry x="560" y="280" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-storage" value="Storage Account" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/storage/Storage_Accounts.svg;" vertex="1" parent="mc-group">
                    <mxGeometry x="360" y="380" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-keyvault" value="Key Vault" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/security/Key_Vaults.svg;" vertex="1" parent="mc-group">
                    <mxGeometry x="460" y="380" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="mc-m365-label" value="M365 Services (MC Cloud)" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;" vertex="1" parent="mc-group">
                    <mxGeometry x="60" y="480" width="168" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="mc-azure-label" value="Azure Resources (MC Cloud)" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;" vertex="1" parent="mc-group">
                    <mxGeometry x="360" y="480" width="168" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="4" value="..." style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;" vertex="1" parent="mc-group">
                    <mxGeometry x="560" y="390" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="22" value="" style="shape=flexArrow;endArrow=classic;startArrow=classic;html=1;" edge="1" parent="mc-group" target="gl-sp">
                    <mxGeometry width="100" height="100" relative="1" as="geometry">
                        <mxPoint x="470" y="128.93" as="sourcePoint"/>
                        <mxPoint x="880" y="130" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="23" value="**User Data Store in Mooncake" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="mc-group">
                    <mxGeometry x="25" y="80" width="190" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="24" value="" style="shape=image;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;labelBackgroundColor=default;verticalAlign=top;verticalLabelPosition=bottom;aspect=fixed;perimeter=ellipsePerimeter;shadow=0;dashed=0;spacingTop=3;image=img/lib/active_directory/sql_server.svg;" vertex="1" parent="mc-group">
                    <mxGeometry x="80" y="130" width="60" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="gl-group" value="Global Tenant (contoso.com) — SP" style="swimlane;rounded=1;html=1;horizontal=1;startSize=36;fillColor=#F2F6FC;strokeColor=#0078D4;strokeWidth=2;" parent="1" vertex="1">
                    <mxGeometry x="960" y="120" width="750" height="590" as="geometry"/>
                </mxCell>
                <mxCell id="gl-sp" value="Entra ID Global" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=14;image=img/lib/azure2/identity/Azure_Active_Directory.svg;fontFamily=Helvetica;fontColor=default;strokeColor=#0078D4;strokeWidth=1.5;fillColor=#FFFFFF;" parent="gl-group" vertex="1">
                    <mxGeometry x="60" y="70" width="210" height="121.15" as="geometry"/>
                </mxCell>
                <mxCell id="gl-webapp" value="Web App" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/app_services/App_Services.svg;" vertex="1" parent="gl-group">
                    <mxGeometry x="480" y="70" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-cosmosdb" value="Cosmos DB" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/databases/Azure_Cosmos_DB.svg;" vertex="1" parent="gl-group">
                    <mxGeometry x="580" y="70" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-power-platform" value="Power Platform" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/power_platform/PowerApps.svg;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="380" y="250" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-powerbi" value="Power BI" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/power_platform/PowerBI.svg;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="480" y="250" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-sentinel" value="Azure Sentinel" style="aspect=fixed;html=1;points=[];align=center;image;fontSize=12;image=img/lib/azure2/security/Azure_Sentinel.svg;" vertex="1" parent="gl-group">
                    <mxGeometry x="390" y="380" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-defender-cloud" value="Defenders" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/security/MS_Defender_EASM.svg;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="170" y="380" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-purview" value="Microsoft Purview" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/databases/Azure_Purview_Accounts.svg;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="280" y="380" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-ellipsis" value="..." style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;" vertex="1" parent="gl-group">
                    <mxGeometry x="480" y="380" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="gl-azure-label" value="Mangae Azure Resources (Global)" style="text;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fontSize=12;fontStyle=1;" vertex="1" parent="gl-group">
                    <mxGeometry x="370" y="180" width="230" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="5" value="Virtual Machine" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/azure2/compute/Virtual_Machines_Classic.svg;points=[];" vertex="1" parent="gl-group">
                    <mxGeometry x="380" y="70" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="6" value="Teams" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_Teams.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_teams;" vertex="1" parent="gl-group">
                    <mxGeometry x="60" y="250" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="10" value="Outlook" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_Outlook.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_outlook;" vertex="1" parent="gl-group">
                    <mxGeometry x="170" y="250" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="12" value="OneDrive" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_OneDrive_for_Business.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_onedrive;" vertex="1" parent="gl-group">
                    <mxGeometry x="280" y="250" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="14" value="SharePoint" style="aspect=fixed;html=1;align=center;image;fontSize=12;image=img/lib/microsoft_office_365/Microsoft_SharePoint_Online.svg;sketch=0;pointerEvents=1;shadow=0;dashed=0;strokeColor=none;fillColor=#DF8C42;labelPosition=center;outlineConnect=0;shape=mxgraph.veeam2.microsoft_sharepoint;" vertex="1" parent="gl-group">
                    <mxGeometry x="60" y="380" width="68" height="68" as="geometry"/>
                </mxCell>
                <mxCell id="19" value="SAML SSO (NameID align with ImmutableID)" style="text;whiteSpace=wrap;html=1;align=left;verticalAlign=middle;fontSize=18;fontStyle=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
                    <mxGeometry x="650" y="190" width="610" height="40" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>